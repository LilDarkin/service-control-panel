<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Service Control Panel</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&family=Poppins:wght@400;500;600&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              dark: {
                50: '#f8fafc',
                100: '#f1f5f9',
                200: '#e2e8f0',
                300: '#cbd5e1',
                400: '#94a3b8',
                500: '#64748b',
                600: '#475569',
                700: '#334155',
                800: '#1e293b',
                900: '#0f172a',
                950: '#020617',
              },
              accent: {
                DEFAULT: '#3b82f6',
                dark: '#2563eb',
                light: '#60a5fa',
              }
            },
          },
        },
      };
    </script>
    <style>
      * {
        -webkit-font-smoothing: antialiased;
      }

      body {
        font-family: system-ui, -apple-system, sans-serif;
        background: #0a0a0f;
      }

      /* Simple solid backgrounds - no gradients */
      .main-bg {
        background: #0c0c12;
      }

      /* Service card - simple solid background */
      .service-card {
        background: rgba(30, 41, 59, 0.5);
        border: 1px solid rgba(148, 163, 184, 0.1);
      }

      .service-card:hover {
        border-color: rgba(59, 130, 246, 0.3);
      }

      /* Sidebar - solid color */
      .sidebar {
        background: #0f1219;
        border-right: 1px solid rgba(148, 163, 184, 0.1);
      }

      /* Status badge - simple fade animation */
      .status-badge.running {
        animation: simple-pulse 2s ease-in-out infinite;
      }

      @keyframes simple-pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.6; }
      }

      /* Simple scrollbar */
      ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }

      ::-webkit-scrollbar-track {
        background: transparent;
      }

      ::-webkit-scrollbar-thumb {
        background: rgba(148, 163, 184, 0.2);
        border-radius: 3px;
      }

      /* Log container */
      .log-container {
        font-family: 'Consolas', 'Courier New', monospace;
        white-space: pre-wrap;
        word-wrap: break-word;
      }

      /* Simple hover states - no animations */
      .nav-item:hover {
        background: rgba(59, 130, 246, 0.1);
      }

      .btn:hover {
        filter: brightness(1.1);
      }

      .btn:active {
        filter: brightness(0.95);
      }

      /* Simple input focus */
      .input-field:focus {
        border-color: rgba(59, 130, 246, 0.5);
        outline: none;
      }

      /* Splash screen - simplified */
      .splash-bg {
        background: #0a0a0f;
      }

      #splash-screen.fade-out {
        opacity: 0;
        transition: opacity 0.3s ease-out;
      }

      /* Modal background */
      .modal-bg {
        background: rgba(0, 0, 0, 0.8);
      }

      .modal-card {
        background: #1e293b;
        border: 1px solid rgba(148, 163, 184, 0.1);
      }
    </style>
  </head>

  <body class="text-white h-screen flex overflow-hidden">
    <!-- Splash Screen - Simplified -->
    <div id="splash-screen" class="fixed inset-0 z-50 flex flex-col items-center justify-center splash-bg">
      <div class="flex flex-col items-center">
        <!-- Simple Logo -->
        <div class="w-20 h-20 mb-6 rounded-xl bg-blue-600 flex items-center justify-center shadow-lg">
          <span class="text-3xl">üöÄ</span>
        </div>

        <h1 class="text-2xl font-bold text-white tracking-wide mb-1">SERVICE PANEL</h1>
        <p class="text-dark-500 text-xs tracking-widest mb-6">PRO EDITION</p>

        <!-- Simple Progress Bar -->
        <div class="w-48 h-1 bg-dark-800 rounded-full overflow-hidden mb-3">
          <div id="splash-progress" class="h-full bg-blue-500 rounded-full" style="width: 0%;"></div>
        </div>

        <p class="text-dark-500 text-xs" id="splash-status">Loading...</p>
      </div>

      <div class="absolute bottom-6 text-dark-700 text-xs">v<span id="splash-version">...</span></div>
    </div>

    <!-- Update Notification Banner -->
    <div id="update-banner" class="hidden fixed top-0 left-0 right-0 z-40 bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg">
      <div class="max-w-screen-xl mx-auto px-4 py-2.5 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div id="update-icon" class="w-6 h-6 rounded-full bg-white/20 flex items-center justify-center text-sm">
            üîÑ
          </div>
          <div>
            <p id="update-title" class="text-sm font-medium">Update Available</p>
            <p id="update-message" class="text-xs text-blue-100">A new version is available</p>
          </div>
        </div>
        <div class="flex items-center gap-2">
          <!-- Progress bar (shown during download) -->
          <div id="update-progress-container" class="hidden w-32 h-1.5 bg-white/20 rounded-full overflow-hidden">
            <div id="update-progress-bar" class="h-full bg-white rounded-full" style="width: 0%"></div>
          </div>
          <span id="update-progress-text" class="hidden text-xs text-blue-100 w-10 text-right"></span>
          
          <!-- Action buttons -->
          <button id="update-action-btn" onclick="app.installUpdate()" class="hidden px-3 py-1 bg-white text-blue-600 text-xs font-medium rounded hover:bg-blue-50">
            Restart Now
          </button>
          <button onclick="app.dismissUpdate()" class="px-2 py-1 text-white/70 hover:text-white text-xs">
            ‚úï
          </button>
        </div>
      </div>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar w-56 flex-shrink-0 flex flex-col">
      <!-- Logo -->
      <div class="p-4 flex items-center gap-3 border-b border-dark-800">
        <div class="w-8 h-8 rounded-lg bg-blue-600 flex items-center justify-center text-base">
          üöÄ
        </div>
        <div>
          <h1 class="text-sm font-semibold text-white">Service Panel</h1>
          <p class="text-[10px] text-dark-500">v<span id="app-version">...</span></p>
        </div>
      </div>

      <!-- Profile Section -->
      <div class="px-3 py-3 border-b border-dark-800">
        <label class="block text-[10px] text-dark-500 uppercase tracking-wider font-medium mb-1.5">Profile</label>
        <select id="profile-select" onchange="app.switchProfile(this.value)" 
          class="input-field w-full px-2.5 py-1.5 rounded-lg bg-dark-900 text-white border border-dark-700 text-xs cursor-pointer">
          <option value="default">Default</option>
        </select>

        <div class="mt-2">
          <label class="block text-[10px] text-dark-500 mb-1">Root Folder</label>
          <div class="flex gap-1">
            <input type="text" id="profile-root-display" readonly 
              class="input-field flex-1 px-2 py-1 rounded-lg bg-dark-900 text-dark-400 text-[10px] border border-dark-700 truncate"
              placeholder="Not set" />
            <button onclick="app.editProfileRoot()" 
              class="btn px-2 py-1 bg-dark-700 hover:bg-dark-600 text-dark-300 rounded-lg text-[10px] border border-dark-700">
              üìÅ
            </button>
          </div>
        </div>

        <button onclick="app.manageProfiles()" class="mt-1.5 text-[10px] text-blue-400 hover:text-blue-300">
          + Manage Profiles
        </button>
      </div>

      <!-- Navigation -->
      <nav class="flex-1 overflow-y-auto py-2 px-2">
        <div class="text-[10px] text-dark-500 uppercase tracking-wider font-medium px-2 py-1.5">Controls</div>
        
        <button onclick="app.startAll()" class="nav-item w-full flex items-center px-2 py-2 text-xs rounded-lg text-dark-300 hover:text-white gap-2">
          <span class="w-5 h-5 rounded bg-green-500/20 flex items-center justify-center text-green-400 text-[10px]">‚ñ∂</span>
          Start All
        </button>
        <button onclick="app.stopAll()" class="nav-item w-full flex items-center px-2 py-2 text-xs rounded-lg text-dark-300 hover:text-white gap-2">
          <span class="w-5 h-5 rounded bg-red-500/20 flex items-center justify-center text-red-400 text-[10px]">‚ñ†</span>
          Stop All
        </button>
        <button onclick="app.restartAll()" class="nav-item w-full flex items-center px-2 py-2 text-xs rounded-lg text-dark-300 hover:text-white gap-2">
          <span class="w-5 h-5 rounded bg-blue-500/20 flex items-center justify-center text-blue-400 text-[10px]">‚Üª</span>
          Restart All
        </button>
        <button id="toggle-all-logs-btn" onclick="app.toggleAllLogs()" class="nav-item w-full flex items-center px-2 py-2 text-xs rounded-lg text-dark-300 hover:text-white gap-2">
          <span class="w-5 h-5 rounded bg-cyan-500/20 flex items-center justify-center text-cyan-400 text-[10px]">üìã</span>
          <span id="toggle-all-logs-text">Show All Logs</span>
        </button>
        <button onclick="app.clearAllLogs()" class="nav-item w-full flex items-center px-2 py-2 text-xs rounded-lg text-dark-300 hover:text-white gap-2">
          <span class="w-5 h-5 rounded bg-orange-500/20 flex items-center justify-center text-orange-400 text-[10px]">üóë</span>
          Clear All Logs
        </button>

        <div class="text-[10px] text-dark-500 uppercase tracking-wider font-medium px-2 py-1.5 mt-3">Actions</div>
        
        <button onclick="app.addService()" class="nav-item w-full flex items-center px-2 py-2 text-xs rounded-lg text-dark-300 hover:text-white gap-2">
          <span class="w-5 h-5 rounded bg-purple-500/20 flex items-center justify-center text-purple-400 text-[10px]">+</span>
          Add Service
        </button>
        <button onclick="app.toggleSettings()" class="nav-item w-full flex items-center px-2 py-2 text-xs rounded-lg text-dark-300 hover:text-white gap-2">
          <span class="w-5 h-5 rounded bg-dark-700 flex items-center justify-center text-dark-400 text-[10px]">‚öô</span>
          Settings
        </button>
      </nav>

      <!-- Footer Actions -->
      <div class="p-3 border-t border-dark-800 space-y-2">
        <button onclick="app.gitPullAll()" class="btn w-full bg-blue-600 hover:bg-blue-500 text-white font-medium py-2 px-3 rounded-lg text-xs flex items-center justify-center gap-2">
          <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
          </svg>
          Git Pull All
        </button>

        <div class="grid grid-cols-2 gap-1.5">
          <button onclick="app.expandAll()" class="btn bg-dark-800 hover:bg-dark-700 text-dark-300 text-[10px] font-medium py-1.5 px-2 rounded-lg border border-dark-700">
            Expand
          </button>
          <button onclick="app.collapseAll()" class="btn bg-dark-800 hover:bg-dark-700 text-dark-300 text-[10px] font-medium py-1.5 px-2 rounded-lg border border-dark-700">
            Collapse
          </button>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col min-w-0 overflow-hidden main-bg">
      <!-- Header -->
      <header class="border-b border-dark-800 py-3 px-5 flex justify-between items-center bg-dark-900/50">
        <div>
          <h2 class="text-base font-semibold text-white">Services Dashboard</h2>
          <p class="text-[10px] text-dark-500">Manage your microservices</p>
        </div>
        <div id="loading" class="text-xs text-blue-400 hidden">Processing...</div>
      </header>

      <!-- Services Grid -->
      <div class="flex-1 overflow-y-auto p-5">
        <div id="services-container" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
          <!-- Services rendered by JS -->
        </div>
      </div>
    </main>

    <!-- Settings Modal -->
    <div id="settings-modal" class="hidden fixed inset-0 modal-bg flex items-center justify-center z-50">
      <div class="modal-card rounded-xl p-5 max-w-md w-full mx-4">
        <div class="flex justify-between items-center mb-5">
          <h2 class="text-lg font-semibold text-white">Settings</h2>
          <button onclick="app.toggleSettings()" class="text-dark-400 hover:text-white text-xl p-1">√ó</button>
        </div>

        <div class="space-y-4">
          <div>
            <h3 class="text-[10px] font-medium text-dark-400 uppercase tracking-wider mb-3">Terminal Appearance</h3>

            <div class="space-y-3">
              <div>
                <div class="flex justify-between mb-1.5">
                  <label class="text-xs text-dark-300">Font Size</label>
                  <span id="font-size-value" class="text-xs text-blue-400">12px</span>
                </div>
                <input type="range" id="log-font-size" min="10" max="24" value="12"
                  class="w-full h-1 bg-dark-700 rounded-full appearance-none cursor-pointer accent-blue-500"
                  oninput="app.updateLogSettings()" />
              </div>

              <div>
                <div class="flex justify-between mb-1.5">
                  <label class="text-xs text-dark-300">Expanded Height</label>
                  <span id="log-height-value" class="text-xs text-blue-400">300px</span>
                </div>
                <input type="range" id="log-height" min="200" max="800" step="50" value="300"
                  class="w-full h-1 bg-dark-700 rounded-full appearance-none cursor-pointer accent-blue-500"
                  oninput="app.updateLogSettings()" />
              </div>

              <div>
                <div class="flex justify-between mb-1.5">
                  <label class="text-xs text-dark-300">Max Log Lines</label>
                  <span id="max-lines-value" class="text-xs text-blue-400">350</span>
                </div>
                <input type="range" id="log-max-lines" min="100" max="1000" step="50" value="350"
                  class="w-full h-1 bg-dark-700 rounded-full appearance-none cursor-pointer accent-blue-500"
                  oninput="app.updateLogSettings()" />
              </div>

              <div>
                <label class="block text-xs text-dark-300 mb-1.5">Font Family</label>
                <select id="log-font-family"
                  class="input-field w-full px-3 py-2 rounded-lg bg-dark-900 text-white border border-dark-700 text-xs"
                  onchange="app.updateLogSettings()">
                  <option value="'Consolas', monospace">Consolas</option>
                  <option value="'Courier New', monospace">Courier New</option>
                  <option value="'Monaco', monospace">Monaco</option>
                  <option value="'Fira Code', monospace">Fira Code</option>
                  <option value="'JetBrains Mono', monospace">JetBrains Mono</option>
                  <option value="'Poppins', sans-serif">Poppins</option>
                  <option value="'Inter', sans-serif">Inter</option>
                  <option value="'Roboto Mono', monospace">Roboto Mono</option>
                </select>
              </div>

              <div class="grid grid-cols-2 gap-3">
                <div>
                  <label class="block text-xs text-dark-300 mb-1.5">Text Color</label>
                  <input type="color" id="log-text-color" class="w-full h-8 rounded cursor-pointer bg-dark-800 border border-dark-700" value="#00ff00" onchange="app.updateLogSettings()" />
                </div>
                <div>
                  <label class="block text-xs text-dark-300 mb-1.5">Background</label>
                  <input type="color" id="log-bg-color" class="w-full h-8 rounded cursor-pointer bg-dark-800 border border-dark-700" value="#000000" onchange="app.updateLogSettings()" />
                </div>
              </div>
            </div>
          </div>

          <div class="pt-3 flex justify-end gap-2 border-t border-dark-700">
            <button onclick="app.resetLogSettings()" class="px-3 py-1.5 text-xs text-red-400 hover:text-red-300 font-medium">
              Reset
            </button>
            <button onclick="app.toggleSettings()" class="btn px-4 py-1.5 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-xs font-medium">
              Done
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Service Modal -->
    <div id="add-service-modal" class="fixed inset-0 modal-bg hidden z-50 flex items-center justify-center">
      <div class="modal-card rounded-xl w-full max-w-md p-5 mx-4">
        <div class="flex justify-between items-center mb-5">
          <h2 class="text-lg font-semibold text-white">Add Service</h2>
          <button onclick="app.cancelNewService()" class="text-dark-400 hover:text-white text-xl p-1">√ó</button>
        </div>

        <div class="space-y-3">
          <div>
            <label class="block text-xs text-dark-400 mb-1.5">Service Name</label>
            <input type="text" id="new-service-name" placeholder="e.g., API Server"
              class="input-field w-full px-3 py-2 rounded-lg bg-dark-900 border border-dark-700 text-white text-xs" />
          </div>

          <div>
            <label class="block text-xs text-dark-400 mb-1.5">Service Path</label>
            <select id="new-service-path" class="input-field w-full px-3 py-2 rounded-lg bg-dark-900 text-white border border-dark-700 text-xs">
              <option value="">Select folder...</option>
            </select>
          </div>

          <div>
            <label class="block text-xs text-dark-400 mb-1.5">Start Command</label>
            <input type="text" id="new-service-command" value="npm start"
              class="input-field w-full px-3 py-2 rounded-lg bg-dark-900 border border-dark-700 text-white text-xs font-mono" />
          </div>
        </div>

        <div class="pt-5 flex justify-end gap-2">
          <button onclick="app.cancelNewService()" class="px-3 py-1.5 text-xs text-dark-400 hover:text-white font-medium">
            Cancel
          </button>
          <button onclick="app.saveNewService()" class="btn px-4 py-1.5 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-xs font-medium">
            Add Service
          </button>
        </div>
      </div>
    </div>

    <!-- Profile Management Modal -->
    <div id="profile-modal" class="fixed inset-0 modal-bg hidden z-50 flex items-center justify-center">
      <div class="modal-card rounded-xl w-full max-w-md p-5 mx-4">
        <div class="flex justify-between items-center mb-5">
          <h2 class="text-lg font-semibold text-white">Manage Profiles</h2>
          <button onclick="app.closeProfileModal()" class="text-dark-400 hover:text-white text-xl p-1">√ó</button>
        </div>

        <!-- Create Profile -->
        <div class="mb-5 pb-5 border-b border-dark-700">
          <h3 class="text-xs font-medium text-dark-300 mb-3">Create New Profile</h3>

          <div class="space-y-2">
            <div>
              <label class="block text-[10px] text-dark-500 mb-1">Profile Name</label>
              <input type="text" id="new-profile-name" placeholder="e.g., Production"
                class="input-field w-full px-3 py-1.5 rounded-lg bg-dark-900 border border-dark-700 text-white text-xs" />
            </div>

            <div>
              <label class="block text-[10px] text-dark-500 mb-1">Parent Directory</label>
              <div class="flex gap-1.5">
                <input type="text" id="new-profile-parent-dir" readonly placeholder="Select folder..."
                  class="input-field flex-1 px-3 py-1.5 rounded-lg bg-dark-900 border border-dark-700 text-white text-xs" />
                <button onclick="app.selectProfileParentDir()" class="btn px-3 py-1.5 bg-dark-700 hover:bg-dark-600 text-white rounded-lg text-xs">
                  Browse
                </button>
              </div>
            </div>

            <button onclick="app.createNewProfile()" class="btn w-full px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-xs font-medium">
              Create Profile
            </button>
          </div>
        </div>

        <!-- Delete Profile -->
        <div>
          <h3 class="text-xs font-medium text-dark-300 mb-3">Delete Profile</h3>
          <div class="flex gap-1.5">
            <select id="delete-profile-select" class="input-field flex-1 px-3 py-1.5 rounded-lg bg-dark-900 text-white border border-dark-700 text-xs">
              <option value="">Select profile to delete...</option>
            </select>
            <button onclick="app.confirmDeleteProfile()" class="btn px-3 py-1.5 bg-red-600 hover:bg-red-500 text-white rounded-lg text-xs font-medium">
              Delete
            </button>
          </div>
          <p class="text-[10px] text-dark-600 mt-1.5">Default profile cannot be deleted</p>
        </div>

        <div class="pt-5 flex justify-end">
          <button onclick="app.closeProfileModal()" class="btn px-4 py-1.5 bg-dark-700 hover:bg-dark-600 text-white rounded-lg text-xs font-medium">
            Close
          </button>
        </div>
      </div>
    </div>

    <!-- Delete Profile Confirmation Modal -->
    <div id="delete-profile-confirm-modal" class="fixed inset-0 modal-bg hidden z-50 flex items-center justify-center">
      <div class="modal-card rounded-xl w-full max-w-sm p-5 border-red-500/20 mx-4">
        <div class="flex items-start gap-3 mb-4">
          <div class="w-8 h-8 rounded-full bg-red-500/20 flex items-center justify-center flex-shrink-0">
            <span class="text-red-400">‚ö†</span>
          </div>
          <div>
            <h3 class="text-base font-semibold text-white mb-1">Delete Profile?</h3>
            <p class="text-xs text-dark-400">
              Delete "<span id="delete-profile-name" class="text-white font-medium"></span>"? This cannot be undone.
            </p>
          </div>
        </div>

        <div class="flex justify-end gap-2">
          <button onclick="app.cancelDeleteProfile()" class="px-3 py-1.5 text-xs text-dark-400 hover:text-white font-medium">
            Cancel
          </button>
          <button onclick="app.confirmDeleteProfileYes()" class="btn px-3 py-1.5 bg-red-600 hover:bg-red-500 text-white rounded-lg text-xs font-medium">
            Delete
          </button>
        </div>
      </div>
    </div>

    <script src="renderer.js"></script>
  </body>
</html>
